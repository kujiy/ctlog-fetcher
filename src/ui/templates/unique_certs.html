<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Unique Certificates - CT Log Dashboard</title>
    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/favicon_io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicon_io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/images/favicon_io/favicon-16x16.png">
    <link rel="manifest" href="/assets/images/favicon_io/site.webmanifest">
    <link rel="shortcut icon" href="/assets/images/favicon_io/favicon.ico">
    <style>
        body { font-family: sans-serif; margin: 2em; }
        h1 { color: #2c3e50; }
        .nav-links { margin-bottom: 2em; }
        .nav-links a { margin-right: 1em; text-decoration: none; color: #3498db; }
        .nav-links a:hover { text-decoration: underline; }
        table { border-collapse: collapse; width: 100%; margin-bottom: 2em; }
        th, td { border: 1px solid #ccc; padding: 0.5em; text-align: left; }
        th { background: #f4f4f4; }
        .error { color: red; }
        .sample-note {
            background-color: #e8f4fd;
            border: 1px solid #bee5eb;
            border-radius: 4px;
            padding: 1em;
            margin-bottom: 2em;
            color: #0c5460;
        }
        .cert-id { font-weight: bold; color: #2c3e50; }
        .cert-fingerprint { font-family: monospace; font-size: 0.9em; }
        .cert-dates { font-size: 0.9em; }
        .wildcard-cert { color: #e67e22; }
        .vetting-level {
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.8em;
            font-weight: bold;
        }
        .vetting-dv { background-color: #d4edda; color: #155724; }
        .vetting-ov { background-color: #fff3cd; color: #856404; }
        .vetting-ev { background-color: #cce5ff; color: #004085; }
    </style>
</head>
<body>
    <div class="nav-links">
        <a href="/">‚Üê Back to Dashboard</a>
        <a href="https://chikkuchiku.notion.site/CT-Log-267a4415c73980a98600c5cd06498da7" target="_blank">üìñ „ÅÇ„Å™„Åü„ÇÇÁ†îÁ©∂„Å´ÂèÇÂä†„Åß„Åç„Åæ„ÅôÔºÅ</a>
    </div>

    <h1>üîí Unique Certificates</h1>

    <div class="sample-note">
        <strong>üìã About the Sample Display:</strong><br>
        This page displays the latest 100 certificates as samples from the certs table in descending order of id. There may be duplicates.
        Many more certificates are stored in the actual database.
    </div>

    {% if error_message %}
        <div class="error">
            <strong>‚ö†Ô∏è Error:</strong> {{ error_message }}
        </div>
    {% elif unique_certs_data %}
        <section>
            <h2>Certificate List (Latest {{ unique_certs_data.count }} entries)</h2>

            {% if unique_certs_data.unique_certs %}
                <div style="overflow-x: auto;">
                    <table>
                        <tr>
                            <th>ID</th>
                            <th>Common Name</th>
                            <th>Issuer</th>
                            <th>Serial Number</th>
                            <th>Not Before</th>
                            <th>Not After</th>
                            <th>Subject Alternative Names</th>
                            <th>Certificate Fingerprint (SHA256)</th>
                            <th>Subject Public Key Hash</th>
                            <th>Public Key Algorithm</th>
                            <th>Key Size</th>
                            <th>Signature Algorithm</th>
                            <th>CT Log Timestamp</th>
                            <th>CRL URLs</th>
                            <th>OCSP URLs</th>
                            <th>Vetting Level</th>
                            <th>SAN Count</th>
                            <th>Issued on Weekend</th>
                            <th>Issued at Night</th>
                            <th>Organization Type</th>
                            <th>Is Wildcard</th>
                            <th>Root CA Issuer Name</th>
                            <th>Is Precertificate</th>
                            <th>Log Name</th>
                            <th>CT Index</th>
                            <th>CT Log URL</th>
                            <th>Worker Name</th>
                            <th>Created At</th>
                            <th>CT Entry</th>
                        </tr>
                        {% for cert in unique_certs_data.unique_certs %}
                        <tr>
                            <td class="cert-id">{{ cert.id }}</td>
                            <td>
                                {% if cert.is_wildcard %}
                                    <span class="wildcard-cert">üåü {{ cert.common_name }}</span>
                                {% else %}
                                    {{ cert.common_name }}
                                {% endif %}
                            </td>
                            <td>{{ cert.issuer if cert.issuer else '-' }}</td>
                            <td>{{ cert.serial_number if cert.serial_number else '-' }}</td>
                            <td class="cert-dates">{{ cert.not_before[:16] if cert.not_before else '-' }}</td>
                            <td class="cert-dates">{{ cert.not_after[:16] if cert.not_after else '-' }}</td>
                            <td style="max-width: 200px; overflow: hidden; text-overflow: ellipsis;">
                                {{ cert.subject_alternative_names if cert.subject_alternative_names else '-' }}
                            </td>
                            <td class="cert-fingerprint">
                                {% if cert.certificate_fingerprint_sha256 %}
                                    {{ cert.certificate_fingerprint_sha256[:16] }}...
                                {% else %}
                                    -
                                {% endif %}
                            </td>
                            <td class="cert-fingerprint">
                                {% if cert.subject_public_key_hash %}
                                    {{ cert.subject_public_key_hash[:16] }}...
                                {% else %}
                                    -
                                {% endif %}
                            </td>
                            <td>{{ cert.public_key_algorithm if cert.public_key_algorithm else '-' }}</td>
                            <td>{{ cert.key_size if cert.key_size is not none else '-' }}</td>
                            <td>{{ cert.signature_algorithm if cert.signature_algorithm else '-' }}</td>
                            <td>{{ cert.ct_log_timestamp if cert.ct_log_timestamp else '-' }}</td>
                            <td style="max-width: 150px; overflow: hidden; text-overflow: ellipsis;">
                                {{ cert.crl_urls if cert.crl_urls else '-' }}
                            </td>
                            <td style="max-width: 150px; overflow: hidden; text-overflow: ellipsis;">
                                {{ cert.ocsp_urls if cert.ocsp_urls else '-' }}
                            </td>
                            <td>
                                {% if cert.vetting_level %}
                                    <span class="vetting-level vetting-{{ cert.vetting_level }}">{{ cert.vetting_level.upper() }}</span>
                                {% else %}
                                    -
                                {% endif %}
                            </td>
                            <td>{{ cert.san_count if cert.san_count is not none else '-' }}</td>
                            <td>
                                {% if cert.issued_on_weekend is not none %}
                                    {% if cert.issued_on_weekend %}‚úÖ{% else %}‚ùå{% endif %}
                                {% else %}
                                    -
                                {% endif %}
                            </td>
                            <td>
                                {% if cert.issued_at_night is not none %}
                                    {% if cert.issued_at_night %}üåÉ{% else %}‚òÄÔ∏è{% endif %}
                                {% else %}
                                    -
                                {% endif %}
                            </td>
                            <td>{{ cert.organization_type if cert.organization_type else '-' }}</td>
                            <td>
                                {% if cert.is_wildcard is not none %}
                                    {% if cert.is_wildcard %}üåü{% else %}-{% endif %}
                                {% else %}
                                    -
                                {% endif %}
                            </td>
                            <td>{{ cert.root_ca_issuer_name if cert.root_ca_issuer_name else '-' }}</td>
                            <td>
                                {% if cert.is_precertificate is not none %}
                                    {% if cert.is_precertificate %}‚úÖ{% else %}‚ùå{% endif %}
                                {% else %}
                                    -
                                {% endif %}
                            </td>
                            <td>{{ cert.log_name if cert.log_name else '-' }}</td>
                            <td>{{ cert.ct_index if cert.ct_index is not none else '-' }}</td>
                            <td style="max-width: 200px; overflow: hidden; text-overflow: ellipsis;">
                                {{ cert.ct_log_url if cert.ct_log_url else '-' }}
                            </td>
                            <td>{{ cert.worker_name if cert.worker_name else '-' }}</td>
                            <td class="cert-dates">{{ cert.created_at[:19] if cert.created_at else '-' }}</td>
                            <td style="max-width: 100px; overflow: hidden; text-overflow: ellipsis;">
                                {% if cert.ct_entry %}
                                    {{ cert.ct_entry[:50] }}...
                                {% else %}
                                    -
                                {% endif %}
                            </td>
                        </tr>
                        {% endfor %}
                    </table>
                </div>
            {% else %}
                <p>No certificate data found.</p>
            {% endif %}
        </section>
    {% else %}
        <p>Loading data...</p>
    {% endif %}

    <div class="nav-links">
        <a href="/">‚Üê Back to Dashboard</a>
    </div>
</body>
</html>
